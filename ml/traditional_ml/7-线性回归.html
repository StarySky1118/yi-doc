<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.classList.toggle('dark', true)
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>七、线性回归 | Yi-Docs</title><meta name="description" content="你好！我是子亿，一名计算机专业在读研究生。这是我的个人博客。">
    <link rel="preload" href="/yi-doc/assets/style-DDc10VHf.css" as="style"><link rel="stylesheet" href="/yi-doc/assets/style-DDc10VHf.css">
    <link rel="modulepreload" href="/yi-doc/assets/app-CdUVeHJs.js"><link rel="modulepreload" href="/yi-doc/assets/7-线性回归.html-BeKU1z_-.js">
    <link rel="prefetch" href="/yi-doc/assets/index.html-C5gkUvqj.js" as="script"><link rel="prefetch" href="/yi-doc/assets/get-started.html-D0k3TY3T.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-CX8lDZzd.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-B7GWBqat.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-BE0rPFGS.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-CQE8ec7u.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-ChTsSQN2.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-快速开始.html-C71vJWQ3.js" as="script"><link rel="prefetch" href="/yi-doc/assets/概述.html-B0KtLDDM.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-排序概述.html-BQTJSF6U.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-快速排序.html-Ni-y9SjO.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-Bo1DX4ln.js" as="script"><link rel="prefetch" href="/yi-doc/assets/go_basic.html-BVkKcsiT.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-BEhK0CFl.js" as="script"><link rel="prefetch" href="/yi-doc/assets/SpringSecurity.html-CNl4HjUW.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-操作系统.html-D9Y1FpT6.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-java.html-BkRCWiDO.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-mysql.html-D3ehU1DC.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-Redis.html-BzTnIVOZ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-计算机网络.html-vwZtjlFD.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Docker.html-CvVmemKU.js" as="script"><link rel="prefetch" href="/yi-doc/assets/0-Python包使用.html-D4UBT49A.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-K近邻算法.html-ziBQmOGE.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-决策树.html-BNLdPk1y.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-朴素贝叶斯.html-Bco_mmNU.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-逻辑回归.html-BqL7sCL4.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-SVM.html-Bw_-J49P.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-集成学习.html-B25pAZFp.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-树回归.html-CFd7sJVg.js" as="script"><link rel="prefetch" href="/yi-doc/assets/9-KMeans.html-B_LLcsdU.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-CSS布局.html-MTBm86eD.js" as="script"><link rel="prefetch" href="/yi-doc/assets/0-附录与补充.html-BFfp_bxX.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-前端工程化与webpack.html-C219AFcr.js" as="script"><link rel="prefetch" href="/yi-doc/assets/10-Vue3.html-BVTN8Yh2.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-Vue基础1.html-DgQpLq_w.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-Vue基础2.html-DNUUPd14.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-生命周期与数据共享.html-CRe0mAKN.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-动态组件、插槽和自定义指令.html-CVzM5oge.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-ESLint.html-mbjN5P3F.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-路由.html-DDveuPuZ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-其他.html-BjdsKgz5.js" as="script"><link rel="prefetch" href="/yi-doc/assets/9-VueX.html-DGGEmqHz.js" as="script"><link rel="prefetch" href="/yi-doc/assets/Gin示例程序.html-c2hgZm3e.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-环境安装.html-CAOWRmay.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-基本结构和基本数据类型.html-gj1PxEHZ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-控制结构.html-Dseg-b_n.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-函数.html-DhRCO1V1.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-数组与切片.html-BjCi6iu3.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-Map.html-YVU1y2Un.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-结构体与方法.html-C56-pLtW.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-接口与反射.html-DTvGL1fz.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-入门案例.html-B3idwPJj.js" as="script"><link rel="prefetch" href="/yi-doc/assets/10-TypeHandler类型转换器.html-CZvk347F.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-CRUD.html-Da621e4h.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-常用注解.html-BxcknNqq.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-条件构造器.html-C4o68Zy1.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-插件.html-BD0hwDSn.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-通用枚举.html-CQKHhhfm.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-代码生成器.html-CM2mEKrM.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-多数据源.html-I5oFOwLb.js" as="script"><link rel="prefetch" href="/yi-doc/assets/9-MybatisX插件.html-D8Sg81Rq.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-基本原理.html-C2dGNIoi.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-认证接口.html-9tWau5Sz.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-其他资源接口.html-5fEWBzKT.js" as="script"><link rel="prefetch" href="/yi-doc/assets/SpringSecurity.html-C0QdyKfw.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-单体项目.html-DZmpJJwa.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-高德地图接入.html-N6_RyhPu.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-AWS_S3.html-r2fM91O6.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Feign.html-BlsL_kx0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-es.html-LTI56tBg.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-MongoDB基础.html-CVxoZNFV.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-单机部署.html-DcYSSh2I.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-基本命令.html-BJsSPRwr.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-索引.html-1WCNAA_l.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-JavaMongo.html-MHUYQmcB.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Redis介绍.html-gsFMI4eO.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-Redis常见命令.html-BciwuoKz.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-RedisJava.html-CUpzZJmZ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-基本概念.html-0S47ib-3.js" as="script"><link rel="prefetch" href="/yi-doc/assets/0-命令大全.html-Db1Hg1H0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Linux简介.html-DGdzgSnQ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-常用命令.html-DAgUJpBt.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-Linux权限.html-d4Ih_Yyh.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-基础篇.html-DEIS8_-a.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-BVvNkvPE.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-索引篇.html-BmAr9NFO.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-事务篇.html-CCGpVXVI.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-使用篇.html-C3_twXRb.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-分库分表篇.html-DhWvChOp.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-集群.html-Drplb6_x.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-BGikOfVJ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-网络模型.html-BJrWw560.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-应用层.html-v5deQWMK.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-传输层.html-vUo2Th6H.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-CwOyH79E.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-数据类型.html-BP6wedCX.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-线程模型.html-BB6M-0UF.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-事务.html-ChERL9nU.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-过期删除与内存淘汰.html-DAlsPyWe.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-集群.html-BjiiOsWw.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-缓存.html-Ctofca82.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-BGwPkIqV.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Ioc.html-7xI3C31H.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-aop.html-B2tOw-Nz.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-MVC.html-gIDXVJQi.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-Dh0vg4CS.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-微服务.html-Ce3E4Fij.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-统一网关.html-C32iSfsk.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-异步通讯.html-B56SVnXl.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-自动化测试介绍.html-B7buIv_G.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-Selenium安装.html-CeawO5Mh.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-SeleniumApi.html-DzhOGiH9.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-单元测试.html-GrvBQzyk.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-常用快捷键.html-Cp3QV7-d.js" as="script"><link rel="prefetch" href="/yi-doc/assets/404.html-BON5g3TI.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/yi-doc/"><!----><span class="vp-site-name" aria-hidden="true">Yi-Docs</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/" aria-label="主页"><!---->主页<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/dev/" aria-label="Web 应用开发"><!---->Web 应用开发<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/yi-doc/ml/" aria-label="机器学习"><!---->机器学习<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/algo/" aria-label="算法"><!---->算法<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/ai_application/" aria-label="AI 应用探索"><!---->AI 应用探索<!----></a></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/" aria-label="主页"><!---->主页<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/dev/" aria-label="Web 应用开发"><!---->Web 应用开发<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/yi-doc/ml/" aria-label="机器学习"><!---->机器学习<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/algo/" aria-label="算法"><!---->算法<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/ai_application/" aria-label="AI 应用探索"><!---->AI 应用探索<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">机器学习 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><p tabindex="0" class="vp-sidebar-item active collapsible">传统机器学习 <span class="down arrow"></span></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/0-Python%E5%8C%85%E4%BD%BF%E7%94%A8.html" aria-label="零、Python 包使用"><!---->零、Python 包使用<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/1-K%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95.html" aria-label="一、K 近邻算法"><!---->一、K 近邻算法<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/2-%E5%86%B3%E7%AD%96%E6%A0%91.html" aria-label="二、决策树"><!---->二、决策树<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/3-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF.html" aria-label="三、朴素贝叶斯"><!---->三、朴素贝叶斯<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/4-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.html" aria-label="四、逻辑回归"><!---->四、逻辑回归<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/5-SVM.html" aria-label="五、支持向量机"><!---->五、支持向量机<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/6-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0.html" aria-label="六、集成学习"><!---->六、集成学习<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/yi-doc/ml/traditional_ml/7-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92.html" aria-label="七、线性回归"><!---->七、线性回归<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/8-%E6%A0%91%E5%9B%9E%E5%BD%92.html" aria-label="八、树回归"><!---->八、树回归<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/9-KMeans.html" aria-label="九、KMeans 聚类"><!---->九、KMeans 聚类<!----></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="七、线性回归" tabindex="-1"><a class="header-anchor" href="#七、线性回归"><span>七、线性回归</span></a></h1><h2 id="_1、基本线性回归-lr" tabindex="-1"><a class="header-anchor" href="#_1、基本线性回归-lr"><span>1、基本线性回归(LR)</span></a></h2><h3 id="_1-算法介绍" tabindex="-1"><a class="header-anchor" href="#_1-算法介绍"><span>(1) 算法介绍</span></a></h3><p>线性回归是一种广泛使用的统计学习方法，旨在建立输入变量和输出变量之间的线性关系。它是一种监督学习算法，通常用于预测数值型输出变量。</p><p><img src="/yi-doc/assets/img_18-DAkiuPPb.png" alt="img_18.png"></p><h3 id="_2-源码分析——线性回归与可视化" tabindex="-1"><a class="header-anchor" href="#_2-源码分析——线性回归与可视化"><span>(2) 源码分析——线性回归与可视化</span></a></h3><p>使用的数据集格式如下：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token number">1.000000</span>	<span class="token number">0.067732</span>	<span class="token number">3.176513</span></span>
<span class="line"><span class="token number">1.000000</span>	<span class="token number">0.427810</span>	<span class="token number">3.816464</span></span>
<span class="line"><span class="token number">1.000000</span>	<span class="token number">0.995731</span>	<span class="token number">4.550095</span></span>
<span class="line"><span class="token number">1.000000</span>	<span class="token number">0.738336</span>	<span class="token number">4.256571</span></span>
<span class="line"><span class="token number">1.000000</span>	<span class="token number">0.981083</span>	<span class="token number">4.560815</span></span>
<span class="line"><span class="token number">1.000000</span>	<span class="token number">0.526171</span>	<span class="token number">3.929515</span></span>
<span class="line"><span class="token number">1.000000</span>	<span class="token number">0.378887</span>	<span class="token number">3.526170</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>有两个特征，但第一个特征全为 1，标签为连续型数值。</p><p><strong>程序入口</strong></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># test for standRegression</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">regression1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    xArr<span class="token punctuation">,</span> yArr <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token string">&quot;./data/data.txt&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    xMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>xArr<span class="token punctuation">)</span></span>
<span class="line">    yMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>yArr<span class="token punctuation">)</span></span>
<span class="line">    ws <span class="token operator">=</span> standRegres<span class="token punctuation">(</span>xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">)</span></span>
<span class="line">    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span></span>
<span class="line">        <span class="token number">111</span><span class="token punctuation">)</span>  <span class="token comment"># add_subplot(349)函数的参数的意思是，将画布分成3行4列图像画在从左到右从上到下第9块</span></span>
<span class="line">    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span></span>
<span class="line">        <span class="token punctuation">[</span>xMat<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span>yMat<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># scatter 的x是xMat中的第二列，y是yMat的第一列</span></span>
<span class="line">    xCopy <span class="token operator">=</span> xMat<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    xCopy<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    yHat <span class="token operator">=</span> xCopy <span class="token operator">*</span> ws</span>
<span class="line">    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>xCopy<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> yHat<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    regression1<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>加载数据集</strong></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">loadDataSet</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot; 加载数据</span>
<span class="line">        解析以tab键分隔的文件中的浮点数</span>
<span class="line">    Returns:</span>
<span class="line">        dataMat :   feature 对应的数据集</span>
<span class="line">        labelMat :  feature 对应的分类标签，即类别标签</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line">    <span class="token comment"># 获取样本特征的总数，不算最后的目标变量</span></span>
<span class="line">    numFeat <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">    dataMat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    labelMat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> line <span class="token keyword">in</span> fr<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 读取每一行</span></span>
<span class="line">        lineArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># 删除一行中以tab分隔的数据前后的空白符号</span></span>
<span class="line">        curLine <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># i 从0到2，不包括2</span></span>
<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>numFeat<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment"># 将数据添加到lineArr List中，每一行数据测试数据组成一个行向量</span></span>
<span class="line">            lineArr<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>curLine<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment"># 将测试数据的输入数据部分存储到dataMat 的List中</span></span>
<span class="line">        dataMat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>lineArr<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 将每一行的最后一个数据，即类别，或者叫目标变量存储到labelMat List中</span></span>
<span class="line">        labelMat<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>curLine<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> dataMat<span class="token punctuation">,</span> labelMat</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>线性回归</strong></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">standRegres</span><span class="token punctuation">(</span>xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">    Description:</span>
<span class="line">        线性回归</span>
<span class="line">    Args:</span>
<span class="line">        xArr : 输入的样本数据，包含每个样本数据的 feature</span>
<span class="line">        yArr : 对应于输入数据的类别标签，也就是每个样本对应的目标变量</span>
<span class="line">    Returns:</span>
<span class="line">        ws: 回归系数</span>
<span class="line">    &#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># mat()函数将xArr，yArr转换为矩阵 mat().T 代表的是对矩阵进行转置操作</span></span>
<span class="line">    xMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>xArr<span class="token punctuation">)</span></span>
<span class="line">    yMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>yArr<span class="token punctuation">)</span><span class="token punctuation">.</span>T</span>
<span class="line">    <span class="token comment"># 矩阵乘法的条件是左矩阵的列数等于右矩阵的行数</span></span>
<span class="line">    xTx <span class="token operator">=</span> xMat<span class="token punctuation">.</span>T <span class="token operator">*</span> xMat</span>
<span class="line">    <span class="token comment"># 因为要用到xTx的逆矩阵，所以事先需要确定计算得到的xTx是否可逆，条件是矩阵的行列式不为0</span></span>
<span class="line">    <span class="token comment"># linalg.det() 函数是用来求得矩阵的行列式的，如果矩阵的行列式为0，则这个矩阵是不可逆的，就无法进行接下来的运算</span></span>
<span class="line">    <span class="token keyword">if</span> linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>xTx<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;This matrix is singular, cannot do inverse&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line">    <span class="token comment"># 最小二乘法</span></span>
<span class="line">    <span class="token comment"># http://cwiki.apachecn.org/pages/viewpage.action?pageId=5505133</span></span>
<span class="line">    <span class="token comment"># 书中的公式，求得w的最优解</span></span>
<span class="line">    ws <span class="token operator">=</span> xTx<span class="token punctuation">.</span>I <span class="token operator">*</span> <span class="token punctuation">(</span>xMat<span class="token punctuation">.</span>T <span class="token operator">*</span> yMat<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> ws</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-sklearn-示例代码" tabindex="-1"><a class="header-anchor" href="#_3-sklearn-示例代码"><span>(3) sklearn 示例代码</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 构造数据</span></span>
<span class="line">X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">y <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 初始化线性回归模型</span></span>
<span class="line">model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练模型</span></span>
<span class="line">model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 预测新的数据</span></span>
<span class="line">X_test <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span>  <span class="token comment"># 输出预测结果</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2、局部加权线性回归-lwlr" tabindex="-1"><a class="header-anchor" href="#_2、局部加权线性回归-lwlr"><span>2、局部加权线性回归(LWLR)</span></a></h2><h3 id="_1-算法介绍-1" tabindex="-1"><a class="header-anchor" href="#_1-算法介绍-1"><span>(1) 算法介绍</span></a></h3><p><img src="/yi-doc/assets/img_19-Dz0ybArj.png" alt="img_19.png"></p><p><img src="/yi-doc/assets/img_20-mrZ48hsm.png" alt="img_20.png"></p><h3 id="_2-源码分析" tabindex="-1"><a class="header-anchor" href="#_2-源码分析"><span>(2) 源码分析</span></a></h3><p>仍然采用和基本线性回归一样的数据集。</p><p><strong>程序入口</strong></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    regression2<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">regression2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    xArr<span class="token punctuation">,</span> yArr <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token string">&quot;./data/data.txt&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    yHat <span class="token operator">=</span> lwlrTest<span class="token punctuation">(</span>xArr<span class="token punctuation">,</span> xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span></span>
<span class="line">    xMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>xArr<span class="token punctuation">)</span></span>
<span class="line">    srtInd <span class="token operator">=</span> xMat<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>argsort<span class="token punctuation">(</span></span>
<span class="line">        <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">#argsort()函数是将x中的元素从小到大排列，提取其对应的index(索引)，然后输出</span></span>
<span class="line">    xSort <span class="token operator">=</span> xMat<span class="token punctuation">[</span>srtInd<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span></span>
<span class="line">    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>xSort<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> yHat<span class="token punctuation">[</span>srtInd<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span></span>
<span class="line">        <span class="token punctuation">[</span>xMat<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>mat<span class="token punctuation">(</span>yArr<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>A<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        s<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">        c<span class="token operator">=</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>局部加权线性回归</strong></p><p>对数据集中的每个点进行预测</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">lwlrTest</span><span class="token punctuation">(</span>testArr<span class="token punctuation">,</span> xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">        Description:</span>
<span class="line">            测试局部加权线性回归，对数据集中每个点调用 lwlr() 函数</span>
<span class="line">        Args:</span>
<span class="line">            testArr: 测试所用的所有样本点</span>
<span class="line">            xArr: 样本的特征数据，即 feature</span>
<span class="line">            yArr: 每个样本对应的类别标签，即目标变量</span>
<span class="line">            k: 控制核函数的衰减速率</span>
<span class="line">        Returns:</span>
<span class="line">            yHat: 预测点的估计值</span>
<span class="line">    &#39;&#39;&#39;</span></span>
<span class="line">    <span class="token comment"># 得到样本点的总数</span></span>
<span class="line">    m <span class="token operator">=</span> shape<span class="token punctuation">(</span>testArr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token comment"># 构建一个全部都是 0 的 1 * m 的矩阵</span></span>
<span class="line">    yHat <span class="token operator">=</span> zeros<span class="token punctuation">(</span>m<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 循环所有的数据点，并将lwlr运用于所有的数据点</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        yHat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> lwlr<span class="token punctuation">(</span>testArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">,</span> k<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 返回估计值</span></span>
<span class="line">    <span class="token keyword">return</span> yHat</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 局部加权线性回归</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">lwlr</span><span class="token punctuation">(</span>testPoint<span class="token punctuation">,</span> xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">        Description:</span>
<span class="line">            局部加权线性回归，在待预测点附近的每个点赋予一定的权重，在子集上基于最小均方差来进行普通的回归。</span>
<span class="line">        Args:</span>
<span class="line">            testPoint: 样本点</span>
<span class="line">            xArr: 样本的特征数据，即 feature</span>
<span class="line">            yArr: 每个样本对应的类别标签，即目标变量</span>
<span class="line">            k:关于赋予权重矩阵的核的一个参数，与权重的衰减速率有关</span>
<span class="line">        Returns:</span>
<span class="line">            testPoint * ws: 数据点与具有权重的系数相乘得到的预测点</span>
<span class="line">        Notes:</span>
<span class="line">            这其中会用到计算权重的公式，w = e^((x^((i))-x) / -2k^2)</span>
<span class="line">            理解: x为某个预测点，x^((i))为样本点，样本点距离预测点越近，贡献的误差越大（权值越大），越远则贡献的误差越小（权值越小）。</span>
<span class="line">            关于预测点的选取，在我的代码中取的是样本点。其中k是带宽参数，控制w（钟形函数）的宽窄程度，类似于高斯函数的标准差。</span>
<span class="line">            算法思路: 假设预测点取样本点中的第i个样本点（共m个样本点），遍历1到m个样本点（含第i个），算出每一个样本点与预测点的距离，</span>
<span class="line">            也就可以计算出每个样本贡献误差的权值，可以看出w是一个有m个元素的向量（写成对角阵形式）。</span>
<span class="line">    &#39;&#39;&#39;</span></span>
<span class="line">    <span class="token comment"># mat() 函数是将array转换为矩阵的函数， mat().T 是转换为矩阵之后，再进行转置操作</span></span>
<span class="line">    xMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>xArr<span class="token punctuation">)</span></span>
<span class="line">    yMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>yArr<span class="token punctuation">)</span><span class="token punctuation">.</span>T</span>
<span class="line">    <span class="token comment"># 获得xMat矩阵的行数</span></span>
<span class="line">    m <span class="token operator">=</span> shape<span class="token punctuation">(</span>xMat<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token comment"># eye()返回一个对角线元素为1，其他元素为0的二维数组，创建权重矩阵weights，该矩阵为每个样本点初始化了一个权重</span></span>
<span class="line">    weights <span class="token operator">=</span> mat<span class="token punctuation">(</span>eye<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># testPoint 的形式是 一个行向量的形式</span></span>
<span class="line">        <span class="token comment"># 计算 testPoint 与输入样本点之间的距离，然后下面计算出每个样本贡献误差的权值</span></span>
<span class="line">        diffMat <span class="token operator">=</span> testPoint <span class="token operator">-</span> xMat<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># k控制衰减的速度</span></span>
<span class="line">        weights<span class="token punctuation">[</span>j<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> exp<span class="token punctuation">(</span>diffMat <span class="token operator">*</span> diffMat<span class="token punctuation">.</span>T <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.0</span> <span class="token operator">*</span> k<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 根据矩阵乘法计算 xTx ，其中的 weights 矩阵是样本点对应的权重矩阵</span></span>
<span class="line">    xTx <span class="token operator">=</span> xMat<span class="token punctuation">.</span>T <span class="token operator">*</span> <span class="token punctuation">(</span>weights <span class="token operator">*</span> xMat<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>xTx<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;This matrix is singular, cannot do inverse&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line">    <span class="token comment"># 计算出回归系数的一个估计</span></span>
<span class="line">    ws <span class="token operator">=</span> xTx<span class="token punctuation">.</span>I <span class="token operator">*</span> <span class="token punctuation">(</span>xMat<span class="token punctuation">.</span>T <span class="token operator">*</span> <span class="token punctuation">(</span>weights <span class="token operator">*</span> yMat<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> testPoint <span class="token operator">*</span> ws</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-存在问题" tabindex="-1"><a class="header-anchor" href="#_3-存在问题"><span>(3) 存在问题</span></a></h3><p>对每条记录进行预测时，需要使用数据集中的全部数据，计算量极大。</p><h2 id="_3、岭回归-ridge-regression" tabindex="-1"><a class="header-anchor" href="#_3、岭回归-ridge-regression"><span>3、岭回归(<strong>Ridge Regression</strong>)</span></a></h2><p><strong>中心化和标准化</strong></p><p>在回归问题和一些机器学习算法中，通常要对原始数据进行中心化和标准化处理，也就是需要将数据的均值调整到0，标准差调整为1, 计算过程很简单就是将所有数据减去平均值后再除以标准差：</p><p><img src="data:image/png;base64,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" alt="img_21.png"></p><p>中心化其实就是个平移过程，将所有数据的中心平移到原点。而标准化则是使得所有数据的不同特征都有相同的尺度 Scale, 这样在使用梯度下降法以及其他方法优化的时候不同特征参数的影响程度就会一致了。</p><h3 id="_1-基本介绍" tabindex="-1"><a class="header-anchor" href="#_1-基本介绍"><span>(1) 基本介绍</span></a></h3><h4 id="_1-原理" tabindex="-1"><a class="header-anchor" href="#_1-原理"><span>1. 原理</span></a></h4><p><img src="/yi-doc/assets/img_22-IOdByI6T.png" alt="img_22.png"></p><h4 id="_2-性质" tabindex="-1"><a class="header-anchor" href="#_2-性质"><span>2. 性质</span></a></h4><p><img src="/yi-doc/assets/img_23-CHa1d2dA.png" alt="img_23.png"></p><h4 id="_3-岭迹图" tabindex="-1"><a class="header-anchor" href="#_3-岭迹图"><span>3. 岭迹图</span></a></h4><p><img src="/yi-doc/assets/img_25-TihJGaG4.png" alt="img_25.png"></p><p><img src="/yi-doc/assets/img_24-CKPaLdu-.png" alt="img_24.png"></p><h3 id="_2-源码分析-1" tabindex="-1"><a class="header-anchor" href="#_2-源码分析-1"><span>(2) 源码分析</span></a></h3><p><strong>数据集概述</strong></p><p>使用 8 个特征预测鲍鱼年龄，数据集中共 4000 多条数据。</p><p><img src="/yi-doc/assets/img_26-CyRgS_Pr.png" alt="img_26.png"></p><p><strong>程序入口</strong></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># test for ridgeRegression</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">regression3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    abX<span class="token punctuation">,</span> abY <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token string">&quot;./data/abalone.txt&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    ridgeWeights <span class="token operator">=</span> ridgeTest<span class="token punctuation">(</span>abX<span class="token punctuation">,</span> abY<span class="token punctuation">)</span></span>
<span class="line">    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span></span>
<span class="line">    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ridgeWeights<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    regression3<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>岭回归</strong></p><p>选定<img src="data:image/png;base64,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" alt="img_27.png">，分别计算岭回归系数。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">ridgeRegres</span><span class="token punctuation">(</span>xMat<span class="token punctuation">,</span> yMat<span class="token punctuation">,</span> lam<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">        Desc:</span>
<span class="line">            这个函数实现了给定 lambda 下的岭回归求解。</span>
<span class="line">            如果数据的特征比样本点还多，就不能再使用上面介绍的的线性回归和局部线性回归了，因为计算 (xTx)^(-1)会出现错误。</span>
<span class="line">            如果特征比样本点还多（n &gt; m），也就是说，输入数据的矩阵x不是满秩矩阵。非满秩矩阵在求逆时会出现问题。</span>
<span class="line">            为了解决这个问题，我们下边讲一下: 岭回归，这是我们要讲的第一种缩减方法。</span>
<span class="line">        Args:</span>
<span class="line">            xMat: 样本的特征数据，即 feature</span>
<span class="line">            yMat: 每个样本对应的类别标签，即目标变量，实际值</span>
<span class="line">            lam: 引入的一个λ值，使得矩阵非奇异</span>
<span class="line">        Returns:</span>
<span class="line">            经过岭回归公式计算得到的回归系数</span>
<span class="line">    &#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line">    xTx <span class="token operator">=</span> xMat<span class="token punctuation">.</span>T <span class="token operator">*</span> xMat</span>
<span class="line">    <span class="token comment"># 岭回归就是在矩阵 xTx 上加一个 λI 从而使得矩阵非奇异，进而能对 xTx + λI 求逆</span></span>
<span class="line">    denom <span class="token operator">=</span> xTx <span class="token operator">+</span> eye<span class="token punctuation">(</span>shape<span class="token punctuation">(</span>xMat<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> lam</span>
<span class="line">    <span class="token comment"># 检查行列式是否为零，即矩阵是否可逆，行列式为0的话就不可逆，不为0的话就是可逆。</span></span>
<span class="line">    <span class="token keyword">if</span> linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>denom<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0.0</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;This matrix is singular, cannot do inverse&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line">    ws <span class="token operator">=</span> denom<span class="token punctuation">.</span>I <span class="token operator">*</span> <span class="token punctuation">(</span>xMat<span class="token punctuation">.</span>T <span class="token operator">*</span> yMat<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> ws</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">ridgeTest</span><span class="token punctuation">(</span>xArr<span class="token punctuation">,</span> yArr<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>
<span class="line">        Desc:</span>
<span class="line">            函数 ridgeTest() 用于在一组 λ 上测试结果</span>
<span class="line">        Args:</span>
<span class="line">            xArr: 样本数据的特征，即 feature</span>
<span class="line">            yArr: 样本数据的类别标签，即真实数据</span>
<span class="line">        Returns:</span>
<span class="line">            wMat: 将所有的回归系数输出到一个矩阵并返回</span>
<span class="line">    &#39;&#39;&#39;</span></span>
<span class="line"></span>
<span class="line">    xMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>xArr<span class="token punctuation">)</span></span>
<span class="line">    yMat <span class="token operator">=</span> mat<span class="token punctuation">(</span>yArr<span class="token punctuation">)</span><span class="token punctuation">.</span>T</span>
<span class="line">    <span class="token comment"># 计算Y的均值</span></span>
<span class="line">    yMean <span class="token operator">=</span> mean<span class="token punctuation">(</span>yMat<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># Y的所有的特征减去均值</span></span>
<span class="line">    yMat <span class="token operator">=</span> yMat <span class="token operator">-</span> yMean</span>
<span class="line">    <span class="token comment"># 标准化 x，计算 xMat 平均值</span></span>
<span class="line">    xMeans <span class="token operator">=</span> mean<span class="token punctuation">(</span>xMat<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 然后计算 X的方差</span></span>
<span class="line">    xVar <span class="token operator">=</span> var<span class="token punctuation">(</span>xMat<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 所有特征都减去各自的均值并除以方差</span></span>
<span class="line">    xMat <span class="token operator">=</span> <span class="token punctuation">(</span>xMat <span class="token operator">-</span> xMeans<span class="token punctuation">)</span> <span class="token operator">/</span> xVar</span>
<span class="line">    <span class="token comment"># 可以在 30 个不同的 lambda 下调用 ridgeRegres() 函数。</span></span>
<span class="line">    numTestPts <span class="token operator">=</span> <span class="token number">30</span></span>
<span class="line">    <span class="token comment"># 创建30 * m 的全部数据为0 的矩阵</span></span>
<span class="line">    wMat <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>numTestPts<span class="token punctuation">,</span> shape<span class="token punctuation">(</span>xMat<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>numTestPts<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># exp() 返回 e^x</span></span>
<span class="line">        ws <span class="token operator">=</span> ridgeRegres<span class="token punctuation">(</span>xMat<span class="token punctuation">,</span> yMat<span class="token punctuation">,</span> exp<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        wMat<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> ws<span class="token punctuation">.</span>T</span>
<span class="line">    <span class="token keyword">return</span> wMat</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-sklearn-中的岭回归" tabindex="-1"><a class="header-anchor" href="#_3-sklearn-中的岭回归"><span>(3) sklearn 中的岭回归</span></a></h3><p><img src="/yi-doc/assets/img_28-hSOxfynh.png" alt="img_28.png"></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> Ridge</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_boston</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载波士顿房价数据集</span></span>
<span class="line">boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 将数据集分为训练集和测试集</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建一个岭回归模型</span></span>
<span class="line">ridge <span class="token operator">=</span> Ridge<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 在训练数据上拟合模型</span></span>
<span class="line">ridge<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 在测试数据上预测</span></span>
<span class="line">y_pred <span class="token operator">=</span> ridge<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 计算均方误差</span></span>
<span class="line">mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Mean squared error: &quot;</span><span class="token punctuation">,</span> mse<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4、lasso-方法" tabindex="-1"><a class="header-anchor" href="#_4、lasso-方法"><span>4、LASSO 方法</span></a></h2><h3 id="_1-基本介绍-1" tabindex="-1"><a class="header-anchor" href="#_1-基本介绍-1"><span>(1) 基本介绍</span></a></h3><p><img src="/yi-doc/assets/img_29-CMNwb8tK.png" alt="img_29.png"></p><p><img src="/yi-doc/assets/img_30-Bju2mC0r.png" alt="img_30.png"></p><h3 id="_2-sklearn-lasso-回归示例代码" tabindex="-1"><a class="header-anchor" href="#_2-sklearn-lasso-回归示例代码"><span>(2) sklearn lasso 回归示例代码</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> Lasso</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_boston</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 加载波士顿房价数据集</span></span>
<span class="line">boston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">X<span class="token punctuation">,</span> y <span class="token operator">=</span> boston<span class="token punctuation">.</span>data<span class="token punctuation">,</span> boston<span class="token punctuation">.</span>target</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 将数据集分成训练集和测试集</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建Lasso回归模型</span></span>
<span class="line">lasso <span class="token operator">=</span> Lasso<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练模型</span></span>
<span class="line">lasso<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 对测试集进行预测</span></span>
<span class="line">y_pred <span class="token operator">=</span> lasso<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 计算均方误差（Mean Squared Error, MSE）</span></span>
<span class="line">mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;均方误差（MSE）：&quot;</span><span class="token punctuation">,</span> mse<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: ecustzzy1@163.com">ZhangZiYi</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/yi-doc/ml/traditional_ml/6-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0.html" aria-label="六、集成学习"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>六、集成学习</span></div></a><a class="route-link auto-link next" href="/yi-doc/ml/traditional_ml/8-%E6%A0%91%E5%9B%9E%E5%BD%92.html" aria-label="八、树回归"><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span>八、树回归</span></div></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/yi-doc/assets/app-CdUVeHJs.js" defer></script>
  </body>
</html>
