<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.classList.toggle('dark', true)
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>六、集成学习 | Yi-Docs</title><meta name="description" content="你好！我是子亿，一名计算机专业在读研究生。这是我的个人博客。">
    <link rel="preload" href="/yi-doc/assets/style-DDc10VHf.css" as="style"><link rel="stylesheet" href="/yi-doc/assets/style-DDc10VHf.css">
    <link rel="modulepreload" href="/yi-doc/assets/app-BDlzwS-c.js"><link rel="modulepreload" href="/yi-doc/assets/6-集成学习.html-B-p6mIgE.js">
    <link rel="prefetch" href="/yi-doc/assets/index.html-BeV9phM0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/get-started.html-BHXqU9Ae.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-BxsP4CT1.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-D6wqHjqc.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-CtxhGVU0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-C3zzCOSg.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-DiXLRZLL.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-快速开始.html-Dv_o0Cqo.js" as="script"><link rel="prefetch" href="/yi-doc/assets/概述.html-CTupYwQW.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-排序概述.html-BuU5SkN3.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-快速排序.html-CE_D_j64.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-CMfMCAVJ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/go_basic.html-BZVMmHXo.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-f4gsyAld.js" as="script"><link rel="prefetch" href="/yi-doc/assets/SpringSecurity.html-ehGznA0X.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-操作系统.html-fUyZSZ-S.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-java.html-45XRL-r3.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-mysql.html-BqVm6SZn.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-Redis.html-9h5CQ0g6.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-计算机网络.html-DG5ypdRY.js" as="script"><link rel="prefetch" href="/yi-doc/assets/0-Python包使用.html-BUNUzyrF.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-K近邻算法.html-3xbwYZ5j.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-决策树.html-Drysa0NY.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-朴素贝叶斯.html-DeSg-oas.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-逻辑回归.html-BmQOOI0c.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-SVM.html-EtzjodeO.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-线性回归.html-B2clKa9n.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-树回归.html-C568lMUA.js" as="script"><link rel="prefetch" href="/yi-doc/assets/9-KMeans.html-Cr7W6NR8.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Docker.html-Co_8HWbw.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-CSS布局.html-BopwH5GV.js" as="script"><link rel="prefetch" href="/yi-doc/assets/0-附录与补充.html-Dc9tpMbV.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-前端工程化与webpack.html-nJt6xM_H.js" as="script"><link rel="prefetch" href="/yi-doc/assets/10-Vue3.html-F9BiNnd-.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-Vue基础1.html-CuFsLobl.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-Vue基础2.html-BMaxCaWn.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-生命周期与数据共享.html-DnZ2VSb5.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-动态组件、插槽和自定义指令.html-BCv0Qkfa.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-ESLint.html-DJryh5WO.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-路由.html-XiOCsNvF.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-其他.html-DO8EEqaC.js" as="script"><link rel="prefetch" href="/yi-doc/assets/9-VueX.html-pA1Dj_7C.js" as="script"><link rel="prefetch" href="/yi-doc/assets/Gin示例程序.html-OpmSYIZ2.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-环境安装.html-CpvrFiGY.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-基本结构和基本数据类型.html-BXBOUJY8.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-控制结构.html-DqDO_ih5.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-函数.html-BHGkrlyv.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-数组与切片.html-CPOj6S_R.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-Map.html-0J9nr3ZP.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-结构体与方法.html-CebEOvi4.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-接口与反射.html-DqKc0TCu.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-入门案例.html-CeGOKfvT.js" as="script"><link rel="prefetch" href="/yi-doc/assets/10-TypeHandler类型转换器.html-CZUcFg0F.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-CRUD.html-Bbyfk7Es.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-常用注解.html-erwgY16S.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-条件构造器.html-BuYmGcH0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-插件.html-BWymoVPp.js" as="script"><link rel="prefetch" href="/yi-doc/assets/6-通用枚举.html-7dMmFFD9.js" as="script"><link rel="prefetch" href="/yi-doc/assets/7-代码生成器.html-BaIEjqsb.js" as="script"><link rel="prefetch" href="/yi-doc/assets/8-多数据源.html-MJ472GFw.js" as="script"><link rel="prefetch" href="/yi-doc/assets/9-MybatisX插件.html-BcVkAL4k.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-基本原理.html-BJw5r77t.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-认证接口.html-Bdt42pTh.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-其他资源接口.html-BoeIxoVy.js" as="script"><link rel="prefetch" href="/yi-doc/assets/SpringSecurity.html-C6rJnsmu.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-单体项目.html-QNeO3NpE.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-高德地图接入.html--d-sdnpf.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-AWS_S3.html-CysS_vsn.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Feign.html-Bh441kVz.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-es.html-CwLOHzko.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-MongoDB基础.html-DsvR4P5X.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-单机部署.html-rVi5fPLe.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-基本命令.html-KZRih-1z.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-索引.html-QMJ_y-tT.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-JavaMongo.html-BSZneloH.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Redis介绍.html-BUkzfCp9.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-Redis常见命令.html-DNRCUytR.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-RedisJava.html-BMriF4dA.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-基本概念.html-CqS2vj_0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/0-命令大全.html-ZE2vZV0H.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Linux简介.html-Cf-qqxQy.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-常用命令.html-C5-CzGhP.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-Linux权限.html-BXdR69fE.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-基础篇.html-D8d7Nilw.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-Dtb8ujF0.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-索引篇.html-BENR6fu2.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-事务篇.html-CYilaL5s.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-使用篇.html-mqTnWIgp.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-分库分表篇.html-JNVOS8eP.js" as="script"><link rel="prefetch" href="/yi-doc/assets/5-集群.html-BOv9f9vX.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-CIAZ6z7E.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-Ioc.html-_buAct4R.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-aop.html-COfoLQgZ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-MVC.html-Cvoi8hVR.js" as="script"><link rel="prefetch" href="/yi-doc/assets/index.html-D05yfedJ.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-微服务.html-3ySdq5MH.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-统一网关.html-8ufGLwXu.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-异步通讯.html-PalZqqgb.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-自动化测试介绍.html-eH8se4Rh.js" as="script"><link rel="prefetch" href="/yi-doc/assets/2-Selenium安装.html-BgyPlPOR.js" as="script"><link rel="prefetch" href="/yi-doc/assets/3-SeleniumApi.html-Dtvrq7_X.js" as="script"><link rel="prefetch" href="/yi-doc/assets/4-单元测试.html-DB7t_RIp.js" as="script"><link rel="prefetch" href="/yi-doc/assets/1-常用快捷键.html-B0-2OWpK.js" as="script"><link rel="prefetch" href="/yi-doc/assets/404.html-DpPsoBmH.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/yi-doc/"><!----><span class="vp-site-name" aria-hidden="true">Yi-Docs</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/" aria-label="主页"><!---->主页<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/dev/" aria-label="Web 应用开发"><!---->Web 应用开发<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/yi-doc/ml/" aria-label="机器学习"><!---->机器学习<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/algo/" aria-label="算法"><!---->算法<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/ai_application/" aria-label="AI 应用探索"><!---->AI 应用探索<!----></a></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/" aria-label="主页"><!---->主页<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/dev/" aria-label="Web 应用开发"><!---->Web 应用开发<!----></a></div><div class="vp-navbar-item"><a class="route-link route-link-active auto-link" href="/yi-doc/ml/" aria-label="机器学习"><!---->机器学习<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/algo/" aria-label="算法"><!---->算法<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/yi-doc/ai_application/" aria-label="AI 应用探索"><!---->AI 应用探索<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">机器学习 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><p tabindex="0" class="vp-sidebar-item active collapsible">传统机器学习 <span class="down arrow"></span></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/0-Python%E5%8C%85%E4%BD%BF%E7%94%A8.html" aria-label="零、Python 包使用"><!---->零、Python 包使用<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/1-K%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95.html" aria-label="一、K 近邻算法"><!---->一、K 近邻算法<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/2-%E5%86%B3%E7%AD%96%E6%A0%91.html" aria-label="二、决策树"><!---->二、决策树<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/3-%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF.html" aria-label="三、朴素贝叶斯"><!---->三、朴素贝叶斯<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/4-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.html" aria-label="四、逻辑回归"><!---->四、逻辑回归<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/5-SVM.html" aria-label="五、支持向量机"><!---->五、支持向量机<!----></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/yi-doc/ml/traditional_ml/6-%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0.html" aria-label="六、集成学习"><!---->六、集成学习<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/7-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92.html" aria-label="七、线性回归"><!---->七、线性回归<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/8-%E6%A0%91%E5%9B%9E%E5%BD%92.html" aria-label="八、树回归"><!---->八、树回归<!----></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/yi-doc/ml/traditional_ml/9-KMeans.html" aria-label="九、KMeans 聚类"><!---->九、KMeans 聚类<!----></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="六、集成学习" tabindex="-1"><a class="header-anchor" href="#六、集成学习"><span>六、集成学习</span></a></h1><p>集成学习(Ensemble Learning)是一种通过将多个分类或回归模型组合在一起来提高预测性能的机器学习技术。它的基本思想是将多个不同的模型结合在一起，以获得比单个模型更好的预测精度。</p><p>在集成学习中，每个模型都会独立地学习训练数据，然后将它们的结果进行组合。常见的集成学习方法包括投票法(Voting)，平均法(Averaging)，Bagging和Boosting等。</p><ul><li>投票法：在投票法中，每个模型都对测试样本进行预测，然后将它们的预测结果进行投票。最终的预测结果是获得票数最多的类别或平均预测概率最高的类别。</li><li>平均法：在平均法中，每个模型对测试样本进行预测，并将它们的预测结果进行平均。最终的预测结果是平均预测结果。</li><li>Bagging：在Bagging中，每个模型都是基于随机抽样的子集数据集进行训练的。最终的预测结果是通过投票法或平均法组合所有模型的预测结果。</li><li>Boosting：在Boosting中，每个模型都是基于先前模型的错误进行训练的。最终的预测结果是通过加权投票或加权平均法组合所有模型的预测结果。</li></ul><p>集成学习可以提高模型的泛化能力，降低过拟合的风险，提高模型的稳定性和准确性，被广泛应用于各种机器学习问题，如图像识别、语音识别、自然语言处理、推荐系统等。</p><h2 id="_1、随机森林" tabindex="-1"><a class="header-anchor" href="#_1、随机森林"><span>1、随机森林</span></a></h2><h3 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介"><span>(1) 简介</span></a></h3><p>随机森林(Random Forest)是一种集成学习(Ensemble Learning)方法，通常用于分类和回归问题。它是由多个决策树(Decision Trees)组成的模型，每个决策树都是一个分类器，对输入数据进行分类，然后通过对每个决策树的结果进行投票或平均值计算来确定最终的输出结果。</p><p>随机森林的关键特点在于随机性，它在建立每个决策树时使用随机子集的特征和训练样本，以减少模型的方差，防止过拟合(Overfitting)。在每个决策树的训练过程中，随机森林通过使用随机选择的特征来分割节点，以确保每个决策树的差异性。此外，随机森林还可以通过平均每个决策树的结果来降低预测误差，并且在处理高维数据和大规模数据集时表现出色。</p><p>随机森林可以应用于许多实际问题，如医学诊断、金融风险管理、图像识别、自然语言处理等领域。它是一种广泛使用的机器学习算法，对于处理复杂的分类和回归问题具有很好的性能和鲁棒性。</p><p><strong>机器学习中的交叉验证</strong> 交叉验证是一种常用的机器学习技术，它用于评估和选择模型的性能。</p><p>在交叉验证中，将数据集分成训练集和测试集两部分。然后使用训练集训练模型，并使用测试集来评估模型的性能。这种方法有一个缺点，就是测试集的性能受到训练集的选择的影响，因此可能不太准确。</p><p>为了解决这个问题，可以使用交叉验证。在交叉验证中，将数据集分成 k 个部分，每次选择其中一个部分作为测试集，其他部分作为训练集。然后用训练集训练模型，并用测试集来评估模型的性能。这个过程重复k次，每次选择不同的测试集。最后将 k 次评估的结果求平均值，作为模型性能的估计值。</p><p>交叉验证的好处是，可以使用全部数据进行模型训练和评估，并且避免了测试集的选择对模型评估的影响。同时，可以更准确地评估模型的性能。</p><p><strong>基尼系数</strong></p><p>机器学习中的基尼系数（Gini coefficient）是用来衡量数据集的纯度的一种指标。在分类问题中，基尼系数常常用来衡量一个特征的重要性，因为一个特征的基尼系数越大，表示使用该特征进行分类的效果越好。</p><p>在二分类问题中，假设数据集D中有两个类别，记为正类和负类，分别占比为p和1-p。则数据集 D 的基尼系数定义为：</p><p>Gini(D) = 2 * p * (1 - p)</p><p>例如，当p=0.5时，D的基尼系数最大，为 0.5，表示此时正类和负类的数量相等，数据集最不确定；当p=0或p=1时，D的基尼系数最小，为0，表示此时数据集中只有一种类别，数据集最纯。</p><p>对于一个特征A，假设它有V个取值，将数据集D根据A划分为V个子集，记第i个子集中的样本集合为Di，则可以计算出使用特征A进行划分的基尼系数：</p><p>Gini_index(D, A) = sum(|Di| / |D| * Gini(Di))</p><p>其中，|Di|表示Di中的样本数量，|D|表示整个数据集D中的样本数量。</p><p>特征A的基尼系数越大，表示使用特征A进行分类的效果越好。因此，在决策树算法中，通常会选择基尼系数最大的特征进行划分。</p><p>总结：二分类数据集有基尼系数，其基尼系数有公式。二分类数据集的特征也有基尼系数，使用特征将数据集做划分后，特征的基尼系数 = sum(子集的权重 * 子集的基尼系数)。</p><h3 id="_2-源码分析" tabindex="-1"><a class="header-anchor" href="#_2-源码分析"><span>(2) 源码分析</span></a></h3><h4 id="_1-数据集概述" tabindex="-1"><a class="header-anchor" href="#_1-数据集概述"><span>1. 数据集概述</span></a></h4><p>文本文件中的每一行记录了声呐信号的 60 个特征值和其所属分类。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token number">0.02</span><span class="token punctuation">,</span><span class="token number">0.0371</span><span class="token punctuation">,</span><span class="token number">0.0428</span><span class="token punctuation">,</span><span class="token number">0.0207</span><span class="token punctuation">,</span><span class="token number">0.0954</span><span class="token punctuation">,</span><span class="token number">0.0986</span><span class="token punctuation">,</span><span class="token number">0.1539</span><span class="token punctuation">,</span><span class="token number">0.1601</span><span class="token punctuation">,</span><span class="token number">0.3109</span><span class="token punctuation">,</span><span class="token number">0.2111</span><span class="token punctuation">,</span><span class="token number">0.1609</span><span class="token punctuation">,</span><span class="token number">0.1582</span><span class="token punctuation">,</span><span class="token number">0.2238</span><span class="token punctuation">,</span><span class="token number">0.0645</span><span class="token punctuation">,</span><span class="token number">0.066</span><span class="token punctuation">,</span><span class="token number">0.2273</span><span class="token punctuation">,</span><span class="token number">0.31</span><span class="token punctuation">,</span><span class="token number">0.2999</span><span class="token punctuation">,</span><span class="token number">0.5078</span><span class="token punctuation">,</span><span class="token number">0.4797</span><span class="token punctuation">,</span><span class="token number">0.5783</span><span class="token punctuation">,</span><span class="token number">0.5071</span><span class="token punctuation">,</span><span class="token number">0.4328</span><span class="token punctuation">,</span><span class="token number">0.555</span><span class="token punctuation">,</span><span class="token number">0.6711</span><span class="token punctuation">,</span><span class="token number">0.6415</span><span class="token punctuation">,</span><span class="token number">0.7104</span><span class="token punctuation">,</span><span class="token number">0.808</span><span class="token punctuation">,</span><span class="token number">0.6791</span><span class="token punctuation">,</span><span class="token number">0.3857</span><span class="token punctuation">,</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token number">0.2604</span><span class="token punctuation">,</span><span class="token number">0.5121</span><span class="token punctuation">,</span><span class="token number">0.7547</span><span class="token punctuation">,</span><span class="token number">0.8537</span><span class="token punctuation">,</span><span class="token number">0.8507</span><span class="token punctuation">,</span><span class="token number">0.6692</span><span class="token punctuation">,</span><span class="token number">0.6097</span><span class="token punctuation">,</span><span class="token number">0.4943</span><span class="token punctuation">,</span><span class="token number">0.2744</span><span class="token punctuation">,</span><span class="token number">0.051</span><span class="token punctuation">,</span><span class="token number">0.2834</span><span class="token punctuation">,</span><span class="token number">0.2825</span><span class="token punctuation">,</span><span class="token number">0.4256</span><span class="token punctuation">,</span><span class="token number">0.2641</span><span class="token punctuation">,</span><span class="token number">0.1386</span><span class="token punctuation">,</span><span class="token number">0.1051</span><span class="token punctuation">,</span><span class="token number">0.1343</span><span class="token punctuation">,</span><span class="token number">0.0383</span><span class="token punctuation">,</span><span class="token number">0.0324</span><span class="token punctuation">,</span><span class="token number">0.0232</span><span class="token punctuation">,</span><span class="token number">0.0027</span><span class="token punctuation">,</span><span class="token number">0.0065</span><span class="token punctuation">,</span><span class="token number">0.0159</span><span class="token punctuation">,</span><span class="token number">0.0072</span><span class="token punctuation">,</span><span class="token number">0.0167</span><span class="token punctuation">,</span><span class="token number">0.018</span><span class="token punctuation">,</span><span class="token number">0.0084</span><span class="token punctuation">,</span><span class="token number">0.009</span><span class="token punctuation">,</span><span class="token number">0.0032</span><span class="token punctuation">,</span>R</span>
<span class="line"><span class="token number">0.0453</span><span class="token punctuation">,</span><span class="token number">0.0523</span><span class="token punctuation">,</span><span class="token number">0.0843</span><span class="token punctuation">,</span><span class="token number">0.0689</span><span class="token punctuation">,</span><span class="token number">0.1183</span><span class="token punctuation">,</span><span class="token number">0.2583</span><span class="token punctuation">,</span><span class="token number">0.2156</span><span class="token punctuation">,</span><span class="token number">0.3481</span><span class="token punctuation">,</span><span class="token number">0.3337</span><span class="token punctuation">,</span><span class="token number">0.2872</span><span class="token punctuation">,</span><span class="token number">0.4918</span><span class="token punctuation">,</span><span class="token number">0.6552</span><span class="token punctuation">,</span><span class="token number">0.6919</span><span class="token punctuation">,</span><span class="token number">0.7797</span><span class="token punctuation">,</span><span class="token number">0.7464</span><span class="token punctuation">,</span><span class="token number">0.9444</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.8874</span><span class="token punctuation">,</span><span class="token number">0.8024</span><span class="token punctuation">,</span><span class="token number">0.7818</span><span class="token punctuation">,</span><span class="token number">0.5212</span><span class="token punctuation">,</span><span class="token number">0.4052</span><span class="token punctuation">,</span><span class="token number">0.3957</span><span class="token punctuation">,</span><span class="token number">0.3914</span><span class="token punctuation">,</span><span class="token number">0.325</span><span class="token punctuation">,</span><span class="token number">0.32</span><span class="token punctuation">,</span><span class="token number">0.3271</span><span class="token punctuation">,</span><span class="token number">0.2767</span><span class="token punctuation">,</span><span class="token number">0.4423</span><span class="token punctuation">,</span><span class="token number">0.2028</span><span class="token punctuation">,</span><span class="token number">0.3788</span><span class="token punctuation">,</span><span class="token number">0.2947</span><span class="token punctuation">,</span><span class="token number">0.1984</span><span class="token punctuation">,</span><span class="token number">0.2341</span><span class="token punctuation">,</span><span class="token number">0.1306</span><span class="token punctuation">,</span><span class="token number">0.4182</span><span class="token punctuation">,</span><span class="token number">0.3835</span><span class="token punctuation">,</span><span class="token number">0.1057</span><span class="token punctuation">,</span><span class="token number">0.184</span><span class="token punctuation">,</span><span class="token number">0.197</span><span class="token punctuation">,</span><span class="token number">0.1674</span><span class="token punctuation">,</span><span class="token number">0.0583</span><span class="token punctuation">,</span><span class="token number">0.1401</span><span class="token punctuation">,</span><span class="token number">0.1628</span><span class="token punctuation">,</span><span class="token number">0.0621</span><span class="token punctuation">,</span><span class="token number">0.0203</span><span class="token punctuation">,</span><span class="token number">0.053</span><span class="token punctuation">,</span><span class="token number">0.0742</span><span class="token punctuation">,</span><span class="token number">0.0409</span><span class="token punctuation">,</span><span class="token number">0.0061</span><span class="token punctuation">,</span><span class="token number">0.0125</span><span class="token punctuation">,</span><span class="token number">0.0084</span><span class="token punctuation">,</span><span class="token number">0.0089</span><span class="token punctuation">,</span><span class="token number">0.0048</span><span class="token punctuation">,</span><span class="token number">0.0094</span><span class="token punctuation">,</span><span class="token number">0.0191</span><span class="token punctuation">,</span><span class="token number">0.014</span><span class="token punctuation">,</span><span class="token number">0.0049</span><span class="token punctuation">,</span><span class="token number">0.0052</span><span class="token punctuation">,</span><span class="token number">0.0044</span><span class="token punctuation">,</span>R</span>
<span class="line"><span class="token number">0.0262</span><span class="token punctuation">,</span><span class="token number">0.0582</span><span class="token punctuation">,</span><span class="token number">0.1099</span><span class="token punctuation">,</span><span class="token number">0.1083</span><span class="token punctuation">,</span><span class="token number">0.0974</span><span class="token punctuation">,</span><span class="token number">0.228</span><span class="token punctuation">,</span><span class="token number">0.2431</span><span class="token punctuation">,</span><span class="token number">0.3771</span><span class="token punctuation">,</span><span class="token number">0.5598</span><span class="token punctuation">,</span><span class="token number">0.6194</span><span class="token punctuation">,</span><span class="token number">0.6333</span><span class="token punctuation">,</span><span class="token number">0.706</span><span class="token punctuation">,</span><span class="token number">0.5544</span><span class="token punctuation">,</span><span class="token number">0.532</span><span class="token punctuation">,</span><span class="token number">0.6479</span><span class="token punctuation">,</span><span class="token number">0.6931</span><span class="token punctuation">,</span><span class="token number">0.6759</span><span class="token punctuation">,</span><span class="token number">0.7551</span><span class="token punctuation">,</span><span class="token number">0.8929</span><span class="token punctuation">,</span><span class="token number">0.8619</span><span class="token punctuation">,</span><span class="token number">0.7974</span><span class="token punctuation">,</span><span class="token number">0.6737</span><span class="token punctuation">,</span><span class="token number">0.4293</span><span class="token punctuation">,</span><span class="token number">0.3648</span><span class="token punctuation">,</span><span class="token number">0.5331</span><span class="token punctuation">,</span><span class="token number">0.2413</span><span class="token punctuation">,</span><span class="token number">0.507</span><span class="token punctuation">,</span><span class="token number">0.8533</span><span class="token punctuation">,</span><span class="token number">0.6036</span><span class="token punctuation">,</span><span class="token number">0.8514</span><span class="token punctuation">,</span><span class="token number">0.8512</span><span class="token punctuation">,</span><span class="token number">0.5045</span><span class="token punctuation">,</span><span class="token number">0.1862</span><span class="token punctuation">,</span><span class="token number">0.2709</span><span class="token punctuation">,</span><span class="token number">0.4232</span><span class="token punctuation">,</span><span class="token number">0.3043</span><span class="token punctuation">,</span><span class="token number">0.6116</span><span class="token punctuation">,</span><span class="token number">0.6756</span><span class="token punctuation">,</span><span class="token number">0.5375</span><span class="token punctuation">,</span><span class="token number">0.4719</span><span class="token punctuation">,</span><span class="token number">0.4647</span><span class="token punctuation">,</span><span class="token number">0.2587</span><span class="token punctuation">,</span><span class="token number">0.2129</span><span class="token punctuation">,</span><span class="token number">0.2222</span><span class="token punctuation">,</span><span class="token number">0.2111</span><span class="token punctuation">,</span><span class="token number">0.0176</span><span class="token punctuation">,</span><span class="token number">0.1348</span><span class="token punctuation">,</span><span class="token number">0.0744</span><span class="token punctuation">,</span><span class="token number">0.013</span><span class="token punctuation">,</span><span class="token number">0.0106</span><span class="token punctuation">,</span><span class="token number">0.0033</span><span class="token punctuation">,</span><span class="token number">0.0232</span><span class="token punctuation">,</span><span class="token number">0.0166</span><span class="token punctuation">,</span><span class="token number">0.0095</span><span class="token punctuation">,</span><span class="token number">0.018</span><span class="token punctuation">,</span><span class="token number">0.0244</span><span class="token punctuation">,</span><span class="token number">0.0316</span><span class="token punctuation">,</span><span class="token number">0.0164</span><span class="token punctuation">,</span><span class="token number">0.0095</span><span class="token punctuation">,</span><span class="token number">0.0078</span><span class="token punctuation">,</span>R</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-具体代码" tabindex="-1"><a class="header-anchor" href="#_2-具体代码"><span>2. 具体代码</span></a></h4><p><strong>主程序</strong></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 加载数据</span></span>
<span class="line">    dataset <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token string">&#39;../data/sonar-all-data.txt&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># n_folds = 5</span></span>
<span class="line">    <span class="token comment"># sub_dataset = cross_validation_split(dataset, 5)</span></span>
<span class="line">    <span class="token comment"># best_split = get_split(sub_dataset[0], 15)</span></span>
<span class="line">    <span class="token comment"># print(n_folds)</span></span>
<span class="line"></span>
<span class="line">    n_folds <span class="token operator">=</span> <span class="token number">5</span>        <span class="token comment"># 分成5份数据，进行交叉验证</span></span>
<span class="line">    max_depth <span class="token operator">=</span> <span class="token number">20</span>     <span class="token comment"># 调参（自己修改） #决策树深度不能太深，不然容易导致过拟合</span></span>
<span class="line">    min_size <span class="token operator">=</span> <span class="token number">1</span>       <span class="token comment"># 决策树的叶子节点最少的元素数量</span></span>
<span class="line">    sample_size <span class="token operator">=</span> <span class="token number">1.0</span>  <span class="token comment"># 做决策树时候的样本的比例</span></span>
<span class="line">    <span class="token comment"># n_features = int((len(dataset[0])-1))</span></span>
<span class="line">    n_features <span class="token operator">=</span> <span class="token number">15</span>     <span class="token comment"># 调参（自己修改） #准确性与多样性之间的权衡</span></span>
<span class="line">    <span class="token keyword">for</span> n_trees <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># 理论上树是越多越好</span></span>
<span class="line">        scores <span class="token operator">=</span> evaluate_algorithm<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> random_forest<span class="token punctuation">,</span> n_folds<span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> sample_size<span class="token punctuation">,</span> n_trees<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 每一次执行本文件时都能产生同一个随机数</span></span>
<span class="line">        seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;random=&#39;</span><span class="token punctuation">,</span> random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Trees: %d&#39;</span> <span class="token operator">%</span> n_trees<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Scores: %s&#39;</span> <span class="token operator">%</span> scores<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Mean Accuracy: %.3f%%&#39;</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token operator">/</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>加载数据</strong></p><p>将文本数据转换为 list 存储。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token function">loadDataSet</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    dataset <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fr<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">for</span> line <span class="token keyword">in</span> fr<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token keyword">not</span> line<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">continue</span></span>
<span class="line">            lineArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">            <span class="token keyword">for</span> featrue <span class="token keyword">in</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment"># strip()返回移除字符串头尾指定的字符生成的新字符串</span></span>
<span class="line">                str_f <span class="token operator">=</span> featrue<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">                <span class="token comment"># isdigit 如果是浮点型数值，就是 false，所以换成 isalpha() 函数</span></span>
<span class="line">                <span class="token comment"># if str_f.isdigit():   # 判断是否是数字</span></span>
<span class="line">                <span class="token keyword">if</span> str_f<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token comment"># 如果是字母，说明是标签</span></span>
<span class="line">                    <span class="token comment"># 添加分类标签</span></span>
<span class="line">                    lineArr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>str_f<span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">                    <span class="token comment"># 将数据集的第column列转换成float形式</span></span>
<span class="line">                    lineArr<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>str_f<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            dataset<span class="token punctuation">.</span>append<span class="token punctuation">(</span>lineArr<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> dataset</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>可调节的参数</strong></p><p><strong>决策树分类器可调节的参数</strong></p><ol><li>criterion：划分时使用的评估准则，可以选择“gini”或“entropy”。</li><li>splitter：划分节点时使用的策略，可以选择“best”或“random”。其中，“best”表示选择最好的划分策略，“random”表示随机选择一个划分策略。</li><li>max_depth：决策树的最大深度。如果不指定，则表示无限制。</li><li>min_samples_split：拆分内部节点所需的最小样本数。可以是整数或浮点数。如果是整数，则表示最小样本数；如果是浮点数，则表示最小样本分数。例如，如果样本总数为1000，min_samples_split=2，则表示内部节点至少需要2个样本才能进行拆分；如果min_samples_split=0.5，则表示内部节点至少需要500个样本才能进行拆分。</li><li>min_samples_leaf：叶子节点所需的最小样本数。与min_samples_split类似，可以是整数或浮点数。</li><li>max_features：在寻找最佳分割时考虑的特征数。可以是整数或浮点数。如果是整数，则表示考虑的特征数量；如果是浮点数，则表示考虑特征数量的百分比。</li><li>max_leaf_nodes：最大叶节点数。如果不指定，则表示无限制。</li><li>class_weight：用于对不同类别的样本赋予不同的权重。可以是“balanced”（自动平衡类别权重）或自定义字典（类别作为键，权重作为值）。</li></ol><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">n_folds <span class="token operator">=</span> <span class="token number">5</span>        <span class="token comment"># 分成5份数据，进行交叉验证</span></span>
<span class="line">max_depth <span class="token operator">=</span> <span class="token number">20</span>     <span class="token comment"># 调参（自己修改） #决策树深度不能太深，不然容易导致过拟合</span></span>
<span class="line">min_size <span class="token operator">=</span> <span class="token number">1</span>       <span class="token comment"># 决策树的叶子节点最少的元素数量</span></span>
<span class="line">sample_size <span class="token operator">=</span> <span class="token number">1.0</span>  <span class="token comment"># 做决策树时候的样本的比例</span></span>
<span class="line"><span class="token comment"># n_features = int((len(dataset[0])-1))</span></span>
<span class="line">n_features <span class="token operator">=</span> <span class="token number">15</span>     <span class="token comment"># 调参（自己修改） #准确性与多样性之间的权衡</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>生成随机森林</strong></p><p>随机森林就是决策树的集合，生成多颗决策树，并利用各个决策树的结果的投票、平均等产生最终结果。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Random Forest Algorithm</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">random_forest</span><span class="token punctuation">(</span>train<span class="token punctuation">,</span> test<span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> sample_size<span class="token punctuation">,</span> n_trees<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;random_forest(评估算法性能，返回模型得分)</span>
<span class="line"></span>
<span class="line">    Args:</span>
<span class="line">        train           训练数据集</span>
<span class="line">        test            测试数据集</span>
<span class="line">        max_depth       决策树深度不能太深，不然容易导致过拟合</span>
<span class="line">        min_size        叶子节点的大小</span>
<span class="line">        sample_size     训练数据集的样本比例</span>
<span class="line">        n_trees         决策树的个数</span>
<span class="line">        n_features      选取的特征的个数</span>
<span class="line">    Returns:</span>
<span class="line">        predictions     每一行的预测结果，bagging 预测最后的分类结果</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line">    trees <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># n_trees 表示决策树的数量</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_trees<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 随机抽样的训练样本， 随机采样保证了每棵决策树训练集的差异性</span></span>
<span class="line">        sample <span class="token operator">=</span> subsample<span class="token punctuation">(</span>train<span class="token punctuation">,</span> sample_size<span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 创建一个决策树</span></span>
<span class="line">        tree <span class="token operator">=</span> build_tree<span class="token punctuation">(</span>sample<span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span></span>
<span class="line">        trees<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tree<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 每一行的预测结果，bagging 预测最后的分类结果</span></span>
<span class="line">    predictions <span class="token operator">=</span> <span class="token punctuation">[</span>bagging_predict<span class="token punctuation">(</span>trees<span class="token punctuation">,</span> row<span class="token punctuation">)</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> test<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">return</span> predictions</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>决策树的生成</strong></p><p>首先需要寻找特征列表中最优的分类特征，最优分类特征即基尼系数最小的特征，最优特征将作为决策树的根结点。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Build a decision tree</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">build_tree</span><span class="token punctuation">(</span>train<span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;build_tree(创建一个决策树)</span>
<span class="line"></span>
<span class="line">    Args:</span>
<span class="line">        train           训练数据集</span>
<span class="line">        max_depth       决策树深度不能太深，不然容易导致过拟合</span>
<span class="line">        min_size        叶子节点的大小</span>
<span class="line">        n_features      选取的特征的个数</span>
<span class="line">    Returns:</span>
<span class="line">        root            返回决策树</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 返回最优列和相关的信息</span></span>
<span class="line">    root <span class="token operator">=</span> get_split<span class="token punctuation">(</span>train<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 对左右2边的数据 进行递归的调用，由于最优特征使用过，所以在后面进行使用的时候，就没有意义了</span></span>
<span class="line">    <span class="token comment"># 例如:  性别-男女，对男使用这一特征就没任何意义了</span></span>
<span class="line">    split<span class="token punctuation">(</span>root<span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> n_features<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> root</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用特征划分数据时涉及到找到最优的特征值，文中代码使用遍历每个取值测试基尼系数的方式。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># 找出分割数据集的最优特征，得到最优的特征 index，特征值 row[index]，以及分割完的数据 groups（left, right）</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">get_split</span><span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 类集合</span></span>
<span class="line">    class_set <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> row <span class="token keyword">in</span> dataset<span class="token punctuation">:</span></span>
<span class="line">        class_set<span class="token punctuation">.</span>add<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    class_values <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>class_set<span class="token punctuation">)</span>  <span class="token comment"># class_values =[0, 1]</span></span>
<span class="line">    b_index<span class="token punctuation">,</span> b_value<span class="token punctuation">,</span> b_score<span class="token punctuation">,</span> b_groups <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">,</span> <span class="token boolean">None</span></span>
<span class="line">    features <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>features<span class="token punctuation">)</span> <span class="token operator">&lt;</span> n_features<span class="token punctuation">:</span></span>
<span class="line">        index <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 往 features 添加 n_features 个特征（ n_feature 等于特征数的根号），特征索引从 dataset 中随机取</span></span>
<span class="line">        <span class="token keyword">if</span> index <span class="token keyword">not</span> <span class="token keyword">in</span> features<span class="token punctuation">:</span></span>
<span class="line">            features<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> index <span class="token keyword">in</span> features<span class="token punctuation">:</span>                    <span class="token comment"># 在 n_features 个特征中选出最优的特征索引，并没有遍历所有特征，从而保证了每课决策树的差异性</span></span>
<span class="line">        <span class="token keyword">for</span> row <span class="token keyword">in</span> dataset<span class="token punctuation">:</span></span>
<span class="line">            groups <span class="token operator">=</span> test_split<span class="token punctuation">(</span>index<span class="token punctuation">,</span> row<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> dataset<span class="token punctuation">)</span>  <span class="token comment"># groups=(left, right), row[index] 遍历每一行 index 索引下的特征值作为分类值 value, 找出最优的分类特征和特征值</span></span>
<span class="line">            gini <span class="token operator">=</span> gini_index<span class="token punctuation">(</span>groups<span class="token punctuation">,</span> class_values<span class="token punctuation">)</span></span>
<span class="line">            <span class="token comment"># 左右两边的数量越一样，说明数据区分度不高，gini系数越大</span></span>
<span class="line">            <span class="token keyword">if</span> gini <span class="token operator">&lt;</span> b_score<span class="token punctuation">:</span></span>
<span class="line">                b_index<span class="token punctuation">,</span> b_value<span class="token punctuation">,</span> b_score<span class="token punctuation">,</span> b_groups <span class="token operator">=</span> index<span class="token punctuation">,</span> row<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> gini<span class="token punctuation">,</span> groups  <span class="token comment"># 最后得到最优的分类特征 b_index,分类特征值 b_value,分类结果 b_groups。b_value 为分错的代价成本</span></span>
<span class="line">    <span class="token comment"># print b_score</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&#39;index&#39;</span><span class="token punctuation">:</span> b_index<span class="token punctuation">,</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">:</span> b_value<span class="token punctuation">,</span> <span class="token string">&#39;groups&#39;</span><span class="token punctuation">:</span> b_groups<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Split a dataset based on an attribute and an attribute value # 根据特征和特征值分割数据集</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">test_split</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">,</span> dataset<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    left<span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> row <span class="token keyword">in</span> dataset<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">if</span> row<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">&lt;</span> value<span class="token punctuation">:</span></span>
<span class="line">            left<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            right<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> left<span class="token punctuation">,</span> right</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token comment"># Create child splits for a node or make terminal  # 创建子分割器，递归分类，直到分类结束</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">split</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> n_features<span class="token punctuation">,</span> depth<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># max_depth = 10, min_size = 1, n_features=int(sqrt((len(dataset[0])-1)</span></span>
<span class="line">    left<span class="token punctuation">,</span> right <span class="token operator">=</span> node<span class="token punctuation">[</span><span class="token string">&#39;groups&#39;</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">del</span><span class="token punctuation">(</span>node<span class="token punctuation">[</span><span class="token string">&#39;groups&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># check for a no split</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> left <span class="token keyword">or</span> <span class="token keyword">not</span> right<span class="token punctuation">:</span></span>
<span class="line">        node<span class="token punctuation">[</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">[</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> to_terminal<span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line"><span class="token comment"># check for max depth</span></span>
<span class="line">    <span class="token keyword">if</span> depth <span class="token operator">&gt;=</span> max_depth<span class="token punctuation">:</span>   <span class="token comment"># max_depth=10 表示递归十次，若分类还未结束，则选取数据中分类标签较多的作为结果，使分类提前结束，防止过拟合</span></span>
<span class="line">        node<span class="token punctuation">[</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> node<span class="token punctuation">[</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> to_terminal<span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> to_terminal<span class="token punctuation">(</span>right<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line"><span class="token comment"># process left child</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> min_size<span class="token punctuation">:</span></span>
<span class="line">        node<span class="token punctuation">[</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> to_terminal<span class="token punctuation">(</span>left<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        node<span class="token punctuation">[</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> get_split<span class="token punctuation">(</span>left<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span>  <span class="token comment"># node[&#39;left&#39;]是一个字典，形式为{&#39;index&#39;:b_index, &#39;value&#39;:b_value, &#39;groups&#39;:b_groups}，所以node是一个多层字典</span></span>
<span class="line">        split<span class="token punctuation">(</span>node<span class="token punctuation">[</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> n_features<span class="token punctuation">,</span> depth<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 递归，depth+1计算递归层数</span></span>
<span class="line"><span class="token comment"># process right child</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> min_size<span class="token punctuation">:</span></span>
<span class="line">        node<span class="token punctuation">[</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> to_terminal<span class="token punctuation">(</span>right<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        node<span class="token punctuation">[</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> get_split<span class="token punctuation">(</span>right<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span></span>
<span class="line">        split<span class="token punctuation">(</span>node<span class="token punctuation">[</span><span class="token string">&#39;right&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max_depth<span class="token punctuation">,</span> min_size<span class="token punctuation">,</span> n_features<span class="token punctuation">,</span> depth<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-sklearn-随机森林示例代码" tabindex="-1"><a class="header-anchor" href="#_3-sklearn-随机森林示例代码"><span>(3) sklearn 随机森林示例代码</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生成随机数据集</span></span>
<span class="line"><span class="token comment"># 1000 个样本、10 个特征、5 个有效特征和 2 个类别</span></span>
<span class="line">X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> n_classes<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 将数据集划分为训练集和测试集</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建随机森林分类器对象</span></span>
<span class="line"><span class="token comment"># 100 棵树</span></span>
<span class="line">clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练随机森林分类器</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 使用训练好的分类器对测试集进行预测</span></span>
<span class="line">y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 输出模型在测试集上的准确率</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Accuracy:&quot;</span><span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2、adaboost" tabindex="-1"><a class="header-anchor" href="#_2、adaboost"><span>2、AdaBoost</span></a></h2><h3 id="_1-算法简介" tabindex="-1"><a class="header-anchor" href="#_1-算法简介"><span>(1) 算法简介</span></a></h3><p>AdaBoost (Adaptive Boosting) 是一种用于二分类和多分类的集成学习算法，它可以将多个弱分类器组合成一个强分类器。AdaBoost 通过反复迭代调整样本的权重来构建分类器，使得分类器在每次迭代中都能够更好地预测训练样本的标签。在每次迭代中，AdaBoost 都会选取一个最佳分类器，该分类器能够使得当前样本的加权分类误差最小化。同时，AdaBoost 会根据分类器的准确度来调整样本的权重，使得分类器在下一次迭代中更加关注分类错误的样本，从而提高分类器的准确度。最终，AdaBoost 通过将多个弱分类器的预测结果进行加权组合，生成一个更加准确的分类结果。</p><p>AdaBoost 是一种非常强大的分类算法，它能够在处理高维数据和大规模数据时表现良好，并且对于一些复杂的分类问题，AdaBoost 也能够获得非常好的分类效果。AdaBoost 的一个重要特点是它不需要对数据进行任何预处理或者特征工程，因此它能够快速地实现和部署。此外，AdaBoost 还有一个非常重要的优点，即它不容易过拟合，因此在很多实际应用中都被广泛使用。</p><p><strong>过拟合的准确定义</strong></p><p><img src="/yi-doc/assets/img_15-CK43EklN.png" alt="img_15.png"></p><p><img src="/yi-doc/assets/img_16-Bx3j6ogQ.png" alt="img_16.png"></p><h3 id="_2-算法过程" tabindex="-1"><a class="header-anchor" href="#_2-算法过程"><span>(2) 算法过程</span></a></h3><p><img src="/yi-doc/assets/img_17-Bc5J5zq4.png" alt="img_17.png"></p><p>ROC 曲线（Receiver Operating Characteristic Curve）是用于评估二元分类器性能的一种工具。它通过将分类器的真阳性率（true positive rate，即分类器正确预测为正例的样本数除以实际正例总数）绘制在 y 轴上，将假阳性率（false positive rate，即分类器错误预测为正例的样本数除以实际负例总数）绘制在 x 轴上，来展示分类器在不同阈值下的性能。</p><p>ROC 曲线上的每个点对应于一个分类器在不同阈值下的真阳性率和假阳性率。ROC 曲线越靠近左上角，表示分类器性能越好，因为此时分类器的真阳性率高、假阳性率低。另外，ROC 曲线下的面积（AUC，Area Under the Curve）也是一个常用的评估指标，AUC 越大，表示分类器性能越好。</p><p>ROC 曲线可以帮助我们在选择分类器时作出合理的决策，尤其是在面对不平衡数据集（即正负样本比例差异很大）的情况下，它可以更好地展示分类器的性能。</p><h3 id="_3-sklearn-adaboost-示例代码" tabindex="-1"><a class="header-anchor" href="#_3-sklearn-adaboost-示例代码"><span>(3) sklearn adaboost 示例代码</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> AdaBoostClassifier</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification</span>
<span class="line"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 生成示例数据集</span></span>
<span class="line">X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">                           n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 将数据集拆分为训练和测试集</span></span>
<span class="line">X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 初始化 AdaBoost 分类器</span></span>
<span class="line">clf <span class="token operator">=</span> AdaBoostClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 训练分类器</span></span>
<span class="line">clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 预测测试数据集</span></span>
<span class="line">y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 输出分类器准确率</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Accuracy:&quot;</span><span class="token punctuation">,</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>可以调整的参数如下：</p><ol><li><code>base_estimator</code>：基础分类器，默认为决策树分类器 <code>DecisionTreeClassifier(max_depth=1)</code>。</li><li><code>n_estimators</code>：弱分类器数量，默认为 50。</li><li><code>learning_rate</code>：每个弱分类器的权重缩减系数，默认为 1。</li><li><code>algorithm</code>：SAMME 或 SAMME.R，默认为 SAMME.R。</li><li><code>random_state</code>：随机种子值，以保证可重复性。</li></ol><p>其中，<code>SAMME</code> 和 <code>SAMME.R</code> 是两种不同的 boosting 算法，区别在于 <code>SAMME.R</code> 在计算分类器权重时使用了概率估计。<code>learning_rate</code> 参数用于控制弱分类器的权重缩减程度，较小的 <code>learning_rate</code> 可以使模型更加稳定，但需要增加 <code>n_estimators</code> 的数量以维持模型的性能。</p></blockquote></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: ecustzzy1@163.com">ZhangZiYi</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/yi-doc/ml/traditional_ml/5-SVM.html" aria-label="五、支持向量机"><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span>五、支持向量机</span></div></a><a class="route-link auto-link next" href="/yi-doc/ml/traditional_ml/7-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92.html" aria-label="七、线性回归"><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span>七、线性回归</span></div></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/yi-doc/assets/app-BDlzwS-c.js" defer></script>
  </body>
</html>
