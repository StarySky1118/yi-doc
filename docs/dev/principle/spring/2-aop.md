# 2. AOP
## Spring AOP 是如何实现的？
Spring AOP 是基于动态代理实现的，包括 JDK 动态代理和 CGLIB 动态代理。

JDK 动态代理基于反射，适用于那些实现了接口的被代理类；

CGLIB 动态代理基于字节码操作，通过生成被代理类的子类实现代理。

SpringBoot 默认使用 CGLIB 动态代理。

## Spring 事务有哪些传播行为？传播行为有什么用？
Spring 事务传播行为可以指定事务的边界。

传播行为可以设置的属性有 `REQUIRED`、`REQUIRED_NEW` 等。

## `@Transactional` 注解在什么场景下会失效？
失效场景分两类：
1. 实现本身带来的限制
2. 使用不当

**实现本身带来的限制**

1. 内部调用注解方法无效。内部调用不会使用代理类。
2. 方法非 `public` 修饰

**使用不当**
1. 注解有个 `rollBackFor` 属性，默认情况下，出现 Unchecked Exception 进行回滚，如果不进行指定，出现其他异常不会回滚
2. 异常被捕获
3. 数据库本身不支持事务
